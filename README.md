# pyhockey

Tool for querying advanced NHL data provided by MoneyPuck.com and NaturalStatTrick.com

## Overview

A straightforward library that uses DuckDB and Polars to query a seperately-maintained database
of data scraped from MoneyPuck (https://www.moneypuck.com) and NaturalStatTrick (https://www.naturalstattrick.com).

Allows for easy access to season-summary data at the player- or team-level, as well as game-by-game data for each team. Game-by-game data is also available for players, but as of October 2025, this is only available for the 2025/2026 NHL season.

## Examples

To get the stats for each player on a team in a specific season with a minimum 1000 minutes of icetime:
```[python]
>>> skater_summaries(team='TOR', season=2024, min_icetime=1000)
shape: (14, 21)
┌──────────┬────────┬──────────────────────┬──────┬──────────┬───────────┬─────────────┬─────────┬────────┬───────┬───────────┬──────────┬───────────────┬──────────────┬─────────────────┬─────────────────────┬──────────────────┬──────────────────────┬───────────────┬──────────────┬────────────────┐
│ playerID ┆ season ┆ name                 ┆ team ┆ position ┆ situation ┆ gamesPlayed ┆ iceTime ┆ points ┆ goals ┆ xGoalsFor ┆ goalsFor ┆ xGoalsAgainst ┆ goalsAgainst ┆ goalsForPerHour ┆ goalsAgainstPerHour ┆ xGoalsForPerHour ┆ xGoalsAgainstPerHour ┆ pointsPerHour ┆ goalsPerHour ┆ averageIceTime │
│ ---      ┆ ---    ┆ ---                  ┆ ---  ┆ ---      ┆ ---       ┆ ---         ┆ ---     ┆ ---    ┆ ---   ┆ ---       ┆ ---      ┆ ---           ┆ ---          ┆ ---             ┆ ---                 ┆ ---              ┆ ---                  ┆ ---           ┆ ---          ┆ ---            │
│ i64      ┆ i64    ┆ str                  ┆ str  ┆ str      ┆ str       ┆ i64         ┆ f64     ┆ f64    ┆ f64   ┆ f64       ┆ f64      ┆ f64           ┆ f64          ┆ f64             ┆ f64                 ┆ f64              ┆ f64                  ┆ f64           ┆ f64          ┆ f64            │
╞══════════╪════════╪══════════════════════╪══════╪══════════╪═══════════╪═════════════╪═════════╪════════╪═══════╪═══════════╪══════════╪═══════════════╪══════════════╪═════════════════╪═════════════════════╪══════════════════╪══════════════════════╪═══════════════╪══════════════╪════════════════╡
│ 8476931  ┆ 2024   ┆ Jake McCabe          ┆ TOR  ┆ D        ┆ all       ┆ 66          ┆ 1419.83 ┆ 23.0   ┆ 2.0   ┆ 64.72     ┆ 76.0     ┆ 74.66         ┆ 75.0         ┆ 3.21            ┆ 3.17                ┆ 2.73             ┆ 3.16                 ┆ 0.97          ┆ 0.08         ┆ 21.51          │
│ 8476872  ┆ 2024   ┆ Scott Laughton       ┆ TOR  ┆ C        ┆ all       ┆ 80          ┆ 1168.03 ┆ 31.0   ┆ 13.0  ┆ 47.29     ┆ 42.0     ┆ 59.62         ┆ 76.0         ┆ 2.16            ┆ 3.9                 ┆ 2.43             ┆ 3.06                 ┆ 1.59          ┆ 0.67         ┆ 14.6           │
│ 8479318  ┆ 2024   ┆ Auston Matthews      ┆ TOR  ┆ C        ┆ all       ┆ 67          ┆ 1371.63 ┆ 78.0   ┆ 33.0  ┆ 101.7     ┆ 105.0    ┆ 82.36         ┆ 78.0         ┆ 4.59            ┆ 3.41                ┆ 4.45             ┆ 3.6                  ┆ 3.41          ┆ 1.44         ┆ 20.47          │
│ 8475690  ┆ 2024   ┆ Chris Tanev          ┆ TOR  ┆ D        ┆ all       ┆ 75          ┆ 1481.2  ┆ 18.0   ┆ 3.0   ┆ 64.67     ┆ 72.0     ┆ 71.17         ┆ 64.0         ┆ 2.92            ┆ 2.59                ┆ 2.62             ┆ 2.88                 ┆ 0.73          ┆ 0.12         ┆ 19.75          │
│ 8482720  ┆ 2024   ┆ Matthew Knies        ┆ TOR  ┆ L        ┆ all       ┆ 78          ┆ 1444.17 ┆ 58.0   ┆ 29.0  ┆ 91.62     ┆ 103.0    ┆ 77.97         ┆ 74.0         ┆ 4.28            ┆ 3.07                ┆ 3.81             ┆ 3.24                 ┆ 2.41          ┆ 1.2          ┆ 18.51          │
│ …        ┆ …      ┆ …                    ┆ …    ┆ …        ┆ …         ┆ …           ┆ …       ┆ …      ┆ …     ┆ …         ┆ …        ┆ …             ┆ …            ┆ …               ┆ …                   ┆ …                ┆ …                    ┆ …             ┆ …            ┆ …              │
│ 8478443  ┆ 2024   ┆ Brandon Carlo        ┆ TOR  ┆ D        ┆ all       ┆ 83          ┆ 1568.7  ┆ 12.0   ┆ 1.0   ┆ 59.18     ┆ 59.0     ┆ 85.97         ┆ 90.0         ┆ 2.26            ┆ 3.44                ┆ 2.26             ┆ 3.29                 ┆ 0.46          ┆ 0.04         ┆ 18.9           │
│ 8477939  ┆ 2024   ┆ William Nylander     ┆ TOR  ┆ R        ┆ all       ┆ 82          ┆ 1599.78 ┆ 84.0   ┆ 45.0  ┆ 109.83    ┆ 122.0    ┆ 83.84         ┆ 67.0         ┆ 4.58            ┆ 2.51                ┆ 4.12             ┆ 3.14                 ┆ 3.15          ┆ 1.69         ┆ 19.51          │
│ 8475171  ┆ 2024   ┆ Oliver Ekman-Larsson ┆ TOR  ┆ D        ┆ all       ┆ 77          ┆ 1622.28 ┆ 29.0   ┆ 4.0   ┆ 82.82     ┆ 86.0     ┆ 71.64         ┆ 70.0         ┆ 3.18            ┆ 2.59                ┆ 3.06             ┆ 2.65                 ┆ 1.07          ┆ 0.15         ┆ 21.07          │
│ 8481122  ┆ 2024   ┆ Simon Benoit         ┆ TOR  ┆ D        ┆ all       ┆ 78          ┆ 1290.62 ┆ 10.0   ┆ 1.0   ┆ 42.76     ┆ 48.0     ┆ 72.78         ┆ 58.0         ┆ 2.23            ┆ 2.7                 ┆ 1.99             ┆ 3.38                 ┆ 0.46          ┆ 0.05         ┆ 16.55          │
│ 8477503  ┆ 2024   ┆ Max Domi             ┆ TOR  ┆ C        ┆ all       ┆ 74          ┆ 1048.67 ┆ 33.0   ┆ 8.0   ┆ 48.57     ┆ 53.0     ┆ 43.75         ┆ 39.0         ┆ 3.03            ┆ 2.23                ┆ 2.78             ┆ 2.5                  ┆ 1.89          ┆ 0.46         ┆ 14.17          │
└──────────┴────────┴──────────────────────┴──────┴──────────┴───────────┴─────────────┴─────────┴────────┴───────┴───────────┴──────────┴───────────────┴──────────────┴─────────────────┴─────────────────────┴──────────────────┴──────────────────────┴───────────────┴──────────────┴────────────────┘

```

Can pass multiple values for team or season, as well as specific the situation ('5on5', '4on5', or '5on4'):
```[python]
>>> skater_summaries(team=['TOR', 'MTL'], season=[2023, 2024], situation='5on5', min_icetime=1000)
shape: (35, 21)
┌──────────┬────────┬──────────────────────┬──────┬──────────┬───────────┬─────────────┬─────────┬────────┬───────┬───────────┬──────────┬───────────────┬──────────────┬─────────────────┬─────────────────────┬──────────────────┬──────────────────────┬───────────────┬──────────────┬────────────────┐
│ playerID ┆ season ┆ name                 ┆ team ┆ position ┆ situation ┆ gamesPlayed ┆ iceTime ┆ points ┆ goals ┆ xGoalsFor ┆ goalsFor ┆ xGoalsAgainst ┆ goalsAgainst ┆ goalsForPerHour ┆ goalsAgainstPerHour ┆ xGoalsForPerHour ┆ xGoalsAgainstPerHour ┆ pointsPerHour ┆ goalsPerHour ┆ averageIceTime │
│ ---      ┆ ---    ┆ ---                  ┆ ---  ┆ ---      ┆ ---       ┆ ---         ┆ ---     ┆ ---    ┆ ---   ┆ ---       ┆ ---      ┆ ---           ┆ ---          ┆ ---             ┆ ---                 ┆ ---              ┆ ---                  ┆ ---           ┆ ---          ┆ ---            │
│ i64      ┆ i64    ┆ str                  ┆ str  ┆ str      ┆ str       ┆ i64         ┆ f64     ┆ f64    ┆ f64   ┆ f64       ┆ f64      ┆ f64           ┆ f64          ┆ f64             ┆ f64                 ┆ f64              ┆ f64                  ┆ f64           ┆ f64          ┆ f64            │
╞══════════╪════════╪══════════════════════╪══════╪══════════╪═══════════╪═════════════╪═════════╪════════╪═══════╪═══════════╪══════════╪═══════════════╪══════════════╪═════════════════╪═════════════════════╪══════════════════╪══════════════════════╪═══════════════╪══════════════╪════════════════╡
│ 8481540  ┆ 2023   ┆ Cole Caufield        ┆ MTL  ┆ R        ┆ 5on5      ┆ 82          ┆ 1239.5  ┆ 38.0   ┆ 16.0  ┆ 50.03     ┆ 58.0     ┆ 53.99         ┆ 44.0         ┆ 2.81            ┆ 2.13                ┆ 2.42             ┆ 2.61                 ┆ 1.84          ┆ 0.77         ┆ 15.12          │
│ 8476875  ┆ 2023   ┆ Mike Matheson        ┆ MTL  ┆ D        ┆ 5on5      ┆ 82          ┆ 1472.85 ┆ 21.0   ┆ 4.0   ┆ 53.18     ┆ 49.0     ┆ 64.35         ┆ 60.0         ┆ 2.0             ┆ 2.44                ┆ 2.17             ┆ 2.62                 ┆ 0.86          ┆ 0.16         ┆ 17.96          │
│ 8483515  ┆ 2023   ┆ Juraj Slafkovsky     ┆ MTL  ┆ L        ┆ 5on5      ┆ 82          ┆ 1192.77 ┆ 33.0   ┆ 13.0  ┆ 51.15     ┆ 53.0     ┆ 53.25         ┆ 53.0         ┆ 2.67            ┆ 2.67                ┆ 2.57             ┆ 2.68                 ┆ 1.66          ┆ 0.65         ┆ 14.55          │
│ 8482087  ┆ 2023   ┆ Kaiden Guhle         ┆ MTL  ┆ D        ┆ 5on5      ┆ 70          ┆ 1253.7  ┆ 19.0   ┆ 4.0   ┆ 43.84     ┆ 48.0     ┆ 51.59         ┆ 59.0         ┆ 2.3             ┆ 2.82                ┆ 2.1              ┆ 2.47                 ┆ 0.91          ┆ 0.19         ┆ 17.91          │
│ 8478133  ┆ 2023   ┆ Jake Evans           ┆ MTL  ┆ C        ┆ 5on5      ┆ 82          ┆ 1015.2  ┆ 22.0   ┆ 5.0   ┆ 37.41     ┆ 34.0     ┆ 44.4          ┆ 42.0         ┆ 2.01            ┆ 2.48                ┆ 2.21             ┆ 2.62                 ┆ 1.3           ┆ 0.3          ┆ 12.38          │
│ …        ┆ …      ┆ …                    ┆ …    ┆ …        ┆ …         ┆ …           ┆ …       ┆ …      ┆ …     ┆ …         ┆ …        ┆ …             ┆ …            ┆ …               ┆ …                   ┆ …                ┆ …                    ┆ …             ┆ …            ┆ …              │
│ 8478443  ┆ 2024   ┆ Brandon Carlo        ┆ TOR  ┆ D        ┆ 5on5      ┆ 83          ┆ 1323.27 ┆ 11.0   ┆ 1.0   ┆ 49.1      ┆ 46.0     ┆ 52.38         ┆ 50.0         ┆ 2.09            ┆ 2.27                ┆ 2.23             ┆ 2.38                 ┆ 0.5           ┆ 0.05         ┆ 15.94          │
│ 8477939  ┆ 2024   ┆ William Nylander     ┆ TOR  ┆ R        ┆ 5on5      ┆ 82          ┆ 1241.83 ┆ 42.0   ┆ 24.0  ┆ 54.43     ┆ 61.0     ┆ 52.17         ┆ 41.0         ┆ 2.95            ┆ 1.98                ┆ 2.63             ┆ 2.52                 ┆ 2.03          ┆ 1.16         ┆ 15.14          │
│ 8475171  ┆ 2024   ┆ Oliver Ekman-Larsson ┆ TOR  ┆ D        ┆ 5on5      ┆ 77          ┆ 1370.22 ┆ 24.0   ┆ 2.0   ┆ 54.29     ┆ 60.0     ┆ 54.14         ┆ 51.0         ┆ 2.63            ┆ 2.23                ┆ 2.38             ┆ 2.37                 ┆ 1.05          ┆ 0.09         ┆ 17.8           │
│ 8481122  ┆ 2024   ┆ Simon Benoit         ┆ TOR  ┆ D        ┆ 5on5      ┆ 78          ┆ 1110.95 ┆ 9.0    ┆ 1.0   ┆ 36.31     ┆ 44.0     ┆ 48.4          ┆ 34.0         ┆ 2.38            ┆ 1.84                ┆ 1.96             ┆ 2.61                 ┆ 0.49          ┆ 0.05         ┆ 14.24          │
│ 8476931  ┆ 2024   ┆ Jake McCabe          ┆ TOR  ┆ D        ┆ 5on5      ┆ 66          ┆ 1173.87 ┆ 21.0   ┆ 2.0   ┆ 46.64     ┆ 59.0     ┆ 41.37         ┆ 41.0         ┆ 3.02            ┆ 2.1                 ┆ 2.38             ┆ 2.11                 ┆ 1.07          ┆ 0.1          ┆ 17.79          │
└──────────┴────────┴──────────────────────┴──────┴──────────┴───────────┴─────────────┴─────────┴────────┴───────┴───────────┴──────────┴───────────────┴──────────────┴─────────────────┴─────────────────────┴──────────────────┴──────────────────────┴───────────────┴──────────────┴────────────────┘
```

When querying multiple seasons, can set `combine_seasons=True` to combine stats for all seasons into a single row:
```[python]
>>> skater_summaries(team='TOR', season=[2022, 2023, 2024], situation='5on5', min_icetime=1000, combine_seasons=True)
shape: (21, 21)
┌──────────┬────────────────┬──────────────────────┬──────┬──────────┬───────────┬─────────────┬─────────┬────────┬───────┬───────────┬──────────┬───────────────┬──────────────┬─────────────────┬─────────────────────┬──────────────────┬──────────────────────┬───────────────┬──────────────┬────────────────┐ 
│ playerID ┆ season         ┆ name                 ┆ team ┆ position ┆ situation ┆ gamesPlayed ┆ iceTime ┆ points ┆ goals ┆ xGoalsFor ┆ goalsFor ┆ xGoalsAgainst ┆ goalsAgainst ┆ goalsForPerHour ┆ goalsAgainstPerHour ┆ xGoalsForPerHour ┆ xGoalsAgainstPerHour ┆ pointsPerHour ┆ goalsPerHour ┆ averageIceTime │ 
│ ---      ┆ ---            ┆ ---                  ┆ ---  ┆ ---      ┆ ---       ┆ ---         ┆ ---     ┆ ---    ┆ ---   ┆ ---       ┆ ---      ┆ ---           ┆ ---          ┆ ---             ┆ ---                 ┆ ---              ┆ ---                  ┆ ---           ┆ ---          ┆ ---            │ 
│ i64      ┆ str            ┆ str                  ┆ str  ┆ str      ┆ str       ┆ i16         ┆ f64     ┆ i16    ┆ i16   ┆ f64       ┆ i16      ┆ f64           ┆ i16          ┆ f64             ┆ f64                 ┆ f64              ┆ f64                  ┆ f64           ┆ f64          ┆ f64            │ 
╞══════════╪════════════════╪══════════════════════╪══════╪══════════╪═══════════╪═════════════╪═════════╪════════╪═══════╪═══════════╪══════════╪═══════════════╪══════════════╪═════════════════╪═════════════════════╪══════════════════╪══════════════════════╪═══════════════╪══════════════╪════════════════╡ 
│ 8470966  ┆ 2022           ┆ Mark Giordano        ┆ TOR  ┆ D        ┆ 5on5      ┆ 78          ┆ 1215.2  ┆ 21     ┆ 2     ┆ 62.49     ┆ 56       ┆ 47.55         ┆ 39           ┆ 2.76            ┆ 1.93                ┆ 3.09             ┆ 2.35                 ┆ 1.04          ┆ 0.1          ┆ 15.58          │ 
│ 8474568  ┆ 2022           ┆ Luke Schenn          ┆ TOR  ┆ D        ┆ 5on5      ┆ 70          ┆ 1015.93 ┆ 20     ┆ 4     ┆ 40.18     ┆ 49       ┆ 47.92         ┆ 47           ┆ 2.89            ┆ 2.78                ┆ 2.37             ┆ 2.83                 ┆ 1.18          ┆ 0.24         ┆ 14.51          │ 
│ 8474673  ┆ 2022,2023      ┆ TJ Brodie            ┆ TOR  ┆ D        ┆ 5on5      ┆ 136         ┆ 2460.82 ┆ 34     ┆ 2     ┆ 108.41    ┆ 114      ┆ 98.62         ┆ 102          ┆ 2.78            ┆ 2.49                ┆ 2.64             ┆ 2.4                  ┆ 0.83          ┆ 0.05         ┆ 18.09          │ 
│ 8475166  ┆ 2022,2023,2024 ┆ John Tavares         ┆ TOR  ┆ C        ┆ 5on5      ┆ 235         ┆ 3278.6  ┆ 113    ┆ 51    ┆ 151.32    ┆ 157      ┆ 133.9         ┆ 123          ┆ 2.87            ┆ 2.25                ┆ 2.77             ┆ 2.45                 ┆ 2.07          ┆ 0.93         ┆ 13.95          │ 
│ 8475171  ┆ 2024           ┆ Oliver Ekman-Larsson ┆ TOR  ┆ D        ┆ 5on5      ┆ 77          ┆ 1370.22 ┆ 24     ┆ 2     ┆ 54.29     ┆ 60       ┆ 54.14         ┆ 51           ┆ 2.63            ┆ 2.23                ┆ 2.38             ┆ 2.37                 ┆ 1.05          ┆ 0.09         ┆ 17.8           │ 
│ …        ┆ …              ┆ …                    ┆ …    ┆ …        ┆ …         ┆ …           ┆ …       ┆ …      ┆ …     ┆ …         ┆ …        ┆ …             ┆ …            ┆ …               ┆ …                   ┆ …                ┆ …                    ┆ …             ┆ …            ┆ …              │ 
│ 8480043  ┆ 2022           ┆ Timothy Liljegren    ┆ TOR  ┆ D        ┆ 5on5      ┆ 67          ┆ 1035.42 ┆ 13     ┆ 5     ┆ 52.53     ┆ 50       ┆ 41.75         ┆ 31           ┆ 2.9             ┆ 1.8                 ┆ 3.04             ┆ 2.42                 ┆ 0.75          ┆ 0.29         ┆ 15.45          │ 
│ 8480144  ┆ 2022           ┆ David Kampf          ┆ TOR  ┆ C        ┆ 5on5      ┆ 82          ┆ 1007.92 ┆ 23     ┆ 7     ┆ 40.85     ┆ 37       ┆ 40.28         ┆ 38           ┆ 2.2             ┆ 2.26                ┆ 2.43             ┆ 2.4                  ┆ 1.37          ┆ 0.42         ┆ 12.29          │ 
│ 8480950  ┆ 2023           ┆ Ilya Lyubushkin      ┆ TOR  ┆ D        ┆ 5on5      ┆ 74          ┆ 1029.3  ┆ 8      ┆ 0     ┆ 37.94     ┆ 37       ┆ 46.46         ┆ 50           ┆ 2.16            ┆ 2.91                ┆ 2.21             ┆ 2.71                 ┆ 0.47          ┆ 0.0          ┆ 13.91          │ 
│ 8481122  ┆ 2024           ┆ Simon Benoit         ┆ TOR  ┆ D        ┆ 5on5      ┆ 78          ┆ 1110.95 ┆ 9      ┆ 1     ┆ 36.31     ┆ 44       ┆ 48.4          ┆ 34           ┆ 2.38            ┆ 1.84                ┆ 1.96             ┆ 2.61                 ┆ 0.49          ┆ 0.05         ┆ 14.24          │ 
│ 8482720  ┆ 2023,2024      ┆ Matthew Knies        ┆ TOR  ┆ L        ┆ 5on5      ┆ 158         ┆ 2103.37 ┆ 68     ┆ 37    ┆ 94.97     ┆ 108      ┆ 83.82         ┆ 84           ┆ 3.08            ┆ 2.4                 ┆ 2.71             ┆ 2.39                 ┆ 1.94          ┆ 1.06         ┆ 13.31          │ 
└──────────┴────────────────┴──────────────────────┴──────┴──────────┴───────────┴─────────────┴─────────┴────────┴───────┴───────────┴──────────┴───────────────┴──────────────┴─────────────────┴─────────────────────┴──────────────────┴──────────────────────┴───────────────┴──────────────┴────────────────┘ 
```